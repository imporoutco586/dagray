[32m2024-06-11 15:07:13 +0800[0m - dagster - [34mDEBUG[0m - trainer_job - 515c5302-9891-4368-b6c5-c4f7b6def056 - 839803 - LOGS_CAPTURED - Started capturing logs in process (pid: 839803).
[32m2024-06-11 15:07:13 +0800[0m - dagster - [34mDEBUG[0m - trainer_job - 515c5302-9891-4368-b6c5-c4f7b6def056 - 839803 - trainer - STEP_START - Started execution of step "trainer".
2024-06-11 15:07:13,350	INFO worker.py:1567 -- Connecting to existing Ray cluster at address: 10.16.22.178:6379...
2024-06-11 15:07:13,358	INFO worker.py:1743 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2024-06-11 15:07:13,442	INFO tune.py:263 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `<FrameworkTrainer>(...)`.
2024-06-11 15:07:13,444	INFO tune.py:622 -- [output] This will use the new output engine with verbosity 1. To disable the new output and use the legacy output engine, set the environment variable RAY_AIR_NEW_OUTPUT=0. For more information, please see https://github.com/ray-project/ray/issues/36949
[36m(TorchTrainer pid=839944)[0m Started distributed worker processes: 
[36m(TorchTrainer pid=839944)[0m - (ip=10.16.22.178, pid=840099) world_rank=0, local_rank=0, node_rank=0
[36m(RayTrainWorker pid=840099)[0m Setting up process group for: env:// [rank=0, world_size=1]
[36m(RayTrainWorker pid=840099)[0m   0%|          | 0/26421880 [00:00<?, ?it/s]
[36m(RayTrainWorker pid=840099)[0m   0%|          | 32768/26421880 [00:00<02:13, 197666.29it/s]
[36m(RayTrainWorker pid=840099)[0m   0%|          | 65536/26421880 [00:00<02:16, 193221.95it/s]
[36m(RayTrainWorker pid=840099)[0m   0%|          | 131072/26421880 [00:00<01:34, 277777.92it/s]
[36m(RayTrainWorker pid=840099)[0m   1%|          | 229376/26421880 [00:00<01:05, 398234.66it/s]
[36m(RayTrainWorker pid=840099)[0m   2%|â–         | 491520/26421880 [00:00<00:32, 806998.38it/s]
[36m(RayTrainWorker pid=840099)[0m   3%|â–Ž         | 851968/26421880 [00:01<00:20, 1244164.81it/s]
[36m(RayTrainWorker pid=840099)[0m   5%|â–         | 1212416/26421880 [00:01<00:16, 1546395.81it/s]
[36m(RayTrainWorker pid=840099)[0m   5%|â–Œ         | 1441792/26421880 [00:01<00:17, 1416243.33it/s]
[36m(RayTrainWorker pid=840099)[0m   6%|â–‹         | 1703936/26421880 [00:01<00:16, 1485790.21it/s]
[36m(RayTrainWorker pid=840099)[0m   8%|â–Š         | 1998848/26421880 [00:01<00:15, 1530336.66it/s]
[36m(RayTrainWorker pid=840099)[0m   9%|â–Š         | 2293760/26421880 [00:01<00:15, 1593344.86it/s]
[36m(RayTrainWorker pid=840099)[0m  10%|â–‰         | 2621440/26421880 [00:02<00:14, 1694055.04it/s]
[36m(RayTrainWorker pid=840099)[0m  11%|â–ˆ         | 2916352/26421880 [00:02<00:13, 1709276.01it/s]
[36m(RayTrainWorker pid=840099)[0m  12%|â–ˆâ–        | 3244032/26421880 [00:02<00:13, 1775864.23it/s]
[36m(RayTrainWorker pid=840099)[0m  14%|â–ˆâ–Ž        | 3571712/26421880 [00:02<00:12, 1822380.99it/s]
[36m(RayTrainWorker pid=840099)[0m  15%|â–ˆâ–        | 3899392/26421880 [00:02<00:12, 1857616.16it/s]
[36m(RayTrainWorker pid=840099)[0m  16%|â–ˆâ–Œ        | 4227072/26421880 [00:02<00:11, 1904384.55it/s]
[36m(RayTrainWorker pid=840099)[0m  17%|â–ˆâ–‹        | 4587520/26421880 [00:03<00:11, 1945304.57it/s]
[36m(RayTrainWorker pid=840099)[0m  19%|â–ˆâ–Š        | 4915200/26421880 [00:03<00:10, 1994381.54it/s]
[36m(RayTrainWorker pid=840099)[0m  20%|â–ˆâ–‰        | 5275648/26421880 [00:03<00:10, 2009305.97it/s]
[36m(RayTrainWorker pid=840099)[0m  21%|â–ˆâ–ˆâ–       | 5636096/26421880 [00:03<00:10, 2044151.03it/s]
[36m(RayTrainWorker pid=840099)[0m  23%|â–ˆâ–ˆâ–Ž       | 5996544/26421880 [00:03<00:09, 2090129.42it/s]
[36m(RayTrainWorker pid=840099)[0m  24%|â–ˆâ–ˆâ–       | 6356992/26421880 [00:03<00:08, 2301138.92it/s]
[36m(RayTrainWorker pid=840099)[0m  26%|â–ˆâ–ˆâ–Œ       | 6750208/26421880 [00:04<00:09, 2068407.09it/s]
[36m(RayTrainWorker pid=840099)[0m  27%|â–ˆâ–ˆâ–‹       | 7110656/26421880 [00:04<00:09, 2109222.72it/s]
[36m(RayTrainWorker pid=840099)[0m  28%|â–ˆâ–ˆâ–Š       | 7471104/26421880 [00:04<00:08, 2336626.74it/s]
[36m(RayTrainWorker pid=840099)[0m  30%|â–ˆâ–ˆâ–‰       | 7864320/26421880 [00:04<00:08, 2113266.66it/s]
[36m(RayTrainWorker pid=840099)[0m  31%|â–ˆâ–ˆâ–ˆâ–      | 8257536/26421880 [00:04<00:08, 2152490.41it/s]
[36m(RayTrainWorker pid=840099)[0m  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 8617984/26421880 [00:04<00:08, 2184729.40it/s]
[36m(RayTrainWorker pid=840099)[0m  34%|â–ˆâ–ˆâ–ˆâ–      | 9011200/26421880 [00:05<00:07, 2207148.17it/s]
[36m(RayTrainWorker pid=840099)[0m  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 9404416/26421880 [00:05<00:07, 2219054.87it/s]
[36m(RayTrainWorker pid=840099)[0m  37%|â–ˆâ–ˆâ–ˆâ–‹      | 9764864/26421880 [00:05<00:06, 2450419.07it/s]
[36m(RayTrainWorker pid=840099)[0m  38%|â–ˆâ–ˆâ–ˆâ–Š      | 10158080/26421880 [00:05<00:07, 2200022.89it/s]
[36m(RayTrainWorker pid=840099)[0m  40%|â–ˆâ–ˆâ–ˆâ–‰      | 10551296/26421880 [00:05<00:07, 2235335.69it/s]
[36m(RayTrainWorker pid=840099)[0m  41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 10944512/26421880 [00:05<00:06, 2221100.56it/s]
[36m(RayTrainWorker pid=840099)[0m  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 11337728/26421880 [00:06<00:06, 2250760.07it/s]
[36m(RayTrainWorker pid=840099)[0m  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 11730944/26421880 [00:06<00:06, 2270208.15it/s]
[36m(RayTrainWorker pid=840099)[0m  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 12124160/26421880 [00:06<00:06, 2285469.20it/s]
[36m(RayTrainWorker pid=840099)[0m  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 12484608/26421880 [00:06<00:05, 2483688.20it/s]
[36m(RayTrainWorker pid=840099)[0m  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 12877824/26421880 [00:06<00:06, 2238699.37it/s]
[36m(RayTrainWorker pid=840099)[0m  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 13271040/26421880 [00:06<00:05, 2263800.01it/s]
[36m(RayTrainWorker pid=840099)[0m  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 13664256/26421880 [00:07<00:05, 2278990.40it/s]
[36m(RayTrainWorker pid=840099)[0m  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 14057472/26421880 [00:07<00:05, 2291973.83it/s]
[36m(RayTrainWorker pid=840099)[0m  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 14450688/26421880 [00:07<00:05, 2259875.04it/s]
[36m(RayTrainWorker pid=840099)[0m  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 14843904/26421880 [00:07<00:05, 2276800.61it/s]
[36m(RayTrainWorker pid=840099)[0m  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 15204352/26421880 [00:07<00:04, 2407950.64it/s]
[36m(RayTrainWorker pid=840099)[0m  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 15597568/26421880 [00:07<00:04, 2369514.46it/s]
[36m(RayTrainWorker pid=840099)[0m  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 15990784/26421880 [00:08<00:04, 2353089.34it/s]
[36m(RayTrainWorker pid=840099)[0m  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 16384000/26421880 [00:08<00:04, 2230913.92it/s]
[36m(RayTrainWorker pid=840099)[0m  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 16777216/26421880 [00:08<00:04, 2159108.18it/s]
[36m(RayTrainWorker pid=840099)[0m  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 17170432/26421880 [00:08<00:04, 2203572.48it/s]
[36m(RayTrainWorker pid=840099)[0m  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 17563648/26421880 [00:08<00:03, 2235695.98it/s]
[36m(RayTrainWorker pid=840099)[0m  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 17956864/26421880 [00:09<00:03, 2260840.34it/s]
[36m(RayTrainWorker pid=840099)[0m  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 18350080/26421880 [00:09<00:03, 2279620.62it/s]
[36m(RayTrainWorker pid=840099)[0m  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 18743296/26421880 [00:09<00:03, 2291749.64it/s]
[36m(RayTrainWorker pid=840099)[0m  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 19136512/26421880 [00:09<00:03, 2416543.46it/s]
[36m(RayTrainWorker pid=840099)[0m  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 19529728/26421880 [00:09<00:02, 2386827.79it/s]
[36m(RayTrainWorker pid=840099)[0m  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 19922944/26421880 [00:09<00:02, 2369293.06it/s]
[36m(RayTrainWorker pid=840099)[0m  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 20316160/26421880 [00:09<00:02, 2476246.72it/s]
[36m(RayTrainWorker pid=840099)[0m  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 20709376/26421880 [00:10<00:02, 2436422.59it/s]
[36m(RayTrainWorker pid=840099)[0m  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 21102592/26421880 [00:10<00:01, 2680059.08it/s]
[36m(RayTrainWorker pid=840099)[0m  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 21397504/26421880 [00:10<00:01, 2604814.36it/s]
[36m(RayTrainWorker pid=840099)[0m  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 21692416/26421880 [00:10<00:02, 2334213.93it/s]
[36m(RayTrainWorker pid=840099)[0m  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 21954560/26421880 [00:10<00:02, 2206833.09it/s]
[36m(RayTrainWorker pid=840099)[0m  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 22347776/26421880 [00:10<00:01, 2385166.92it/s]
[36m(RayTrainWorker pid=840099)[0m  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 22773760/26421880 [00:11<00:01, 2422519.15it/s]
[36m(RayTrainWorker pid=840099)[0m  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 23134208/26421880 [00:11<00:01, 2324327.09it/s]
[36m(RayTrainWorker pid=840099)[0m  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 23560192/26421880 [00:11<00:01, 2268582.55it/s]
[36m(RayTrainWorker pid=840099)[0m  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 23986176/26421880 [00:11<00:01, 2232900.47it/s]
[36m(RayTrainWorker pid=840099)[0m  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 24412160/26421880 [00:11<00:00, 2307907.93it/s]
[36m(RayTrainWorker pid=840099)[0m  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 24805376/26421880 [00:11<00:00, 2573583.85it/s]
[36m(RayTrainWorker pid=840099)[0m  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 25231360/26421880 [00:12<00:00, 2553544.38it/s]
[36m(RayTrainWorker pid=840099)[0m  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 25657344/26421880 [00:12<00:00, 2413393.39it/s]
[36m(RayTrainWorker pid=840099)[0m  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 26083328/26421880 [00:12<00:00, 2443037.45it/s]
[36m(RayTrainWorker pid=840099)[0m 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 26421880/26421880 [00:12<00:00, 2126146.04it/s]
[36m(RayTrainWorker pid=840099)[0m   0%|          | 0/29515 [00:00<?, ?it/s]
[36m(RayTrainWorker pid=840099)[0m 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29515/29515 [00:00<00:00, 172749.98it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29515/29515 [00:00<00:00, 172507.33it/s]
[36m(RayTrainWorker pid=840099)[0m   0%|          | 0/4422102 [00:00<?, ?it/s]
[36m(RayTrainWorker pid=840099)[0m   1%|          | 32768/4422102 [00:00<00:23, 190752.05it/s]
[36m(RayTrainWorker pid=840099)[0m   1%|â–         | 65536/4422102 [00:00<00:22, 189474.47it/s]
[36m(RayTrainWorker pid=840099)[0m   3%|â–Ž         | 131072/4422102 [00:00<00:15, 274192.10it/s]
[36m(RayTrainWorker pid=840099)[0m   5%|â–Œ         | 229376/4422102 [00:00<00:10, 389406.91it/s]
[36m(RayTrainWorker pid=840099)[0m  10%|â–ˆ         | 458752/4422102 [00:00<00:05, 731163.85it/s]
[36m(RayTrainWorker pid=840099)[0m  17%|â–ˆâ–‹        | 753664/4422102 [00:01<00:03, 1058259.44it/s]
[36m(RayTrainWorker pid=840099)[0m  23%|â–ˆâ–ˆâ–Ž       | 1015808/4422102 [00:01<00:02, 1216841.52it/s]
[36m(RayTrainWorker pid=840099)[0m  30%|â–ˆâ–ˆâ–ˆ       | 1343488/4422102 [00:01<00:02, 1431757.13it/s]
[36m(RayTrainWorker pid=840099)[0m  38%|â–ˆâ–ˆâ–ˆâ–Š      | 1671168/4422102 [00:01<00:01, 1574148.06it/s]
[36m(RayTrainWorker pid=840099)[0m  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1998848/4422102 [00:01<00:01, 1677516.73it/s]
[36m(RayTrainWorker pid=840099)[0m  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 2359296/4422102 [00:01<00:01, 1802161.89it/s]
[36m(RayTrainWorker pid=840099)[0m  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 2719744/4422102 [00:02<00:00, 1927027.95it/s]
[36m(RayTrainWorker pid=840099)[0m  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 3112960/4422102 [00:02<00:00, 2035030.48it/s]
[36m(RayTrainWorker pid=840099)[0m  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 3538944/4422102 [00:02<00:00, 2133317.35it/s]
[36m(RayTrainWorker pid=840099)[0m  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 3964928/4422102 [00:02<00:00, 2237386.66it/s]
[36m(RayTrainWorker pid=840099)[0m 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4422102/4422102 [00:02<00:00, 2362914.97it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4422102/4422102 [00:02<00:00, 1602284.23it/s]
[36m(RayTrainWorker pid=840099)[0m   0%|          | 0/5148 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5148/5148 [00:00<00:00, 6001188.71it/s]
[36m(RayTrainWorker pid=840099)[0m Moving model to device: cpu
2024-06-11 15:08:43,878	INFO tune.py:1016 -- Wrote the latest version of all result files and experiment state to '/home/kaiyuan/ray_results/TorchTrainer_2024-06-11_15-07-13' in 0.0041s.
[32m2024-06-11 15:08:44 +0800[0m - dagster - [34mDEBUG[0m - trainer_job - 515c5302-9891-4368-b6c5-c4f7b6def056 - 839803 - trainer - STEP_OUTPUT - Yielded output "result" of type "Any". (Type check passed).
[32m2024-06-11 15:08:44 +0800[0m - dagster - [34mDEBUG[0m - trainer_job - 515c5302-9891-4368-b6c5-c4f7b6def056 - trainer - Writing file at: /home/kaiyuan/Desktop/dag_ray/dagster-quickstart/envtest/storage/trainer using PickledObjectFilesystemIOManager...
[32m2024-06-11 15:08:44 +0800[0m - dagster - [34mDEBUG[0m - trainer_job - 515c5302-9891-4368-b6c5-c4f7b6def056 - 839803 - trainer - ASSET_MATERIALIZATION - Materialized value trainer.
[32m2024-06-11 15:08:44 +0800[0m - dagster - [34mDEBUG[0m - trainer_job - 515c5302-9891-4368-b6c5-c4f7b6def056 - 839803 - trainer - HANDLED_OUTPUT - Handled output "result" using IO manager "io_manager"
[32m2024-06-11 15:08:44 +0800[0m - dagster - [34mDEBUG[0m - trainer_job - 515c5302-9891-4368-b6c5-c4f7b6def056 - 839803 - trainer - STEP_SUCCESS - Finished execution of step "trainer" in 1m31s.
